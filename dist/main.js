(()=>{"use strict";function t(t){const e=new Date(t);return`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]}, ${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`}function e(t,e,n){let r;return r=void 0===n?`Weather=${t}, Moment=Day.${e}`:`Weather=${t}, Moment=${n=n.is_day?"Day":"Night"}.${e}`,"svg"===e?`./images/icons/${r}`:`./images/backgrounds/${r}`}function n(t,e){return e?`${o(t.day.maxtemp_c)}째c`:`${o(t.temp_c)}째c`}function r(t){return`${o(t.day.mintemp_c)}째c`}function o(t){return Math.ceil(t)}function a(t){const e={Clear:[1e3],Rain:[1063,1069,1180,1183,1186,1189,1192,1195,1198,1201,1237,1240,1243,1246,1249,1252,1261,1264],Storm:[1087,1273,1276,1279,1282],Cloudy:[1006,1009,1030,1072,1117,1135,1147,1150,1153,1168,1171,1204,1207],"Few Clouds":[1003],Snow:[1066,1114,1210,1213,1216,1219,1222,1225,1255,1258]};return Object.keys(e).find((n=>e[n].includes(t)))}function c(t){const e=document.querySelector(".main__error-prompter");e.querySelector(".error-prompter__heading").textContent=t,e.classList.toggle("main__error-prompter--active"),setTimeout((()=>{e.classList.toggle("main__error-prompter--active")}),4e3)}function i(t,e){const n=t.parentElement.parentElement;"main__intro"===n.classList[0]&&("on"===e?n.classList.add("main__intro--form-activated"):n.className="main__intro")}function s(c){(function(o){const c=document.querySelector(".meta-wrapper__location p"),i=document.querySelector(".meta-wrapper__location time"),s=document.querySelector(".meta-wrapper__time time"),l=document.querySelector(".current__temp"),u=document.querySelector(".range__min-to-max"),m=document.querySelector(".weather-condition__string"),d=document.querySelector(".stat-data__illustration"),p=document.querySelector(".header-container__statistics");var _,y;c.textContent=`${(_=o.location).name}, ${_.region} - ${_.country}`,i.textContent=t(o.location.localtime),s.textContent=o.location.localtime.split(" ")[1],l.textContent=n(o.current,!1),u.textContent=(y=l.textContent,`${r(o.forecast.forecastday[0])} / ${y}`),m.textContent=a(o.current.condition.code),d.src=e(m.textContent,"svg",o.current),p.style.backgroundImage=`url("${e(m.textContent,"png",o.current)}")`})(c),function(t){const e={thermalSensation:`${o(t.current.feelslike_c)}째c`,rainProbability:`${t.forecast.forecastday[0].day.daily_chance_of_rain}%`,windSpeed:`${o(t.current.wind_kph)} Km/h`,humidity:`${t.current.humidity}%`,uvIndex:t.current.uv},n=Object.keys(e),r=document.querySelector(".overview-section__list");for(let t=0;t<r.children.length;t++)r.children[t].children[1].textContent=e[n[t]]}(c),function(o){const c=o.forecast.forecastday,i=document.querySelector(".predictions__list");i.innerHTML="";for(let o=1;o<c.length;o++){const s=document.createElement("li"),l=c[o],u=t(l.date).split(",")[0],m=a(l.day.condition.code);s.innerHTML=`<span class="list__day">\n                            ${u.substring(0,3)}\n                              <span class="day__trimmed-part">\n                                ${u.substring(3)}\n                              </span>\n                            </span>\n                            <img src="${e(m,"svg")}" alt="">\n\n                            <p class="list__stats">\n                                <span class="stats__weather">\n                                    <span class="weather__sr-only">Weather Condition</span>\n                                    ${m}\n                                </span>\n\n                                <span class="list__temp-range">\n                                <span class="temp-range__sr-only">Temperature Range</span>\n                                    ${n(l,!0)}\n                                <abbr title="to" class="sr-only">-</abbr>\n                                <span class="temp-range__to">\n                                    ${r(l)}\n                                </span>\n                                </span>\n                            </p>`,i.appendChild(s)}}(c)}function l(t,e){t.style.opacity=0,i(t,"off"),void 0===e&&u(t.nextElementSibling,"disabled"),setTimeout((()=>{t.innerHTML=""}),600)}function u(t,e){"active"===e?t.classList.add("form__submit-btn--active"):t.classList.remove("form__submit-btn--active")}function m(t){t.classList.toggle("form__submit-btn--loading")}!function(){const t=document.querySelectorAll("input"),e=document.querySelectorAll("form"),n=document.querySelectorAll(".form__suggestions-list"),r=document.querySelectorAll(".form__submit-btn");e.forEach((t=>t.addEventListener("submit",(t=>t.preventDefault())))),t.forEach((t=>t.addEventListener("input",(t=>{const e=t.target.value.toLowerCase();var n,r;""!==e?(n=function(t){const e=[];for(const n of data)n.substr(0,t.length).toLowerCase()==t&&e.push(n);return e}(e),(r=t.target.nextElementSibling).innerHTML="",n.forEach((t=>{const e=document.createElement("li");e.innerHTML=`<button>${t}</button>`,r.appendChild(e)})),i(r,"on"),setTimeout((()=>{r.style.opacity=1,u(r.nextElementSibling,"active")}),100)):l(t.target.nextElementSibling)})))),n.forEach((t=>t.addEventListener("click",(t=>{t.target.classList.add("active"),setTimeout((()=>{try{t.target.parentElement.parentElement.previousElementSibling.value=t.target.textContent,l(t.target.parentElement.parentElement,"dontHideBtn")}catch(t){}}),500)})))),r.forEach((t=>t.addEventListener("click",(t=>{const e=t.target.parentElement.children[1].value;if(""!==e){if(!navigator.onLine)return c("Oops! You're currently offline");m(t.target),async function(t){try{const e=await fetch(`http://localhost:3000/weather?location=${t}`);if(console.log(e),e.ok){const t=await e.json();return console.log(t),s(t),new Promise((t=>setTimeout(t,1500)))}throw new Error}catch(t){return console.log(t),c("Location not found"),Promise.reject(t)}}(e).then((()=>function(){const t=document.querySelector("main");t.classList.add("main--dashboard-active"),function(t){document.querySelector(".header-wrapper__header").addEventListener("click",(()=>{t.classList=""}))}(t)}())).catch((t=>{})).finally((()=>{l(t.target.parentElement.children[2]),t.target.parentElement.children[1].value="",m(t.target)}))}}))))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QiwwQ0FBMEMzRSxLQUc1QyxHQURBNEUsUUFBUUMsSUFBSUgsR0FDUkEsRUFBU0ksR0FBSSxDQUNmLE1BQU1DLFFBQWlCTCxFQUFTTSxPQU1oQyxPQUpBSixRQUFRQyxJQUFJRSxHQUVaNUYsRUFBcUI0RixHQUVkLElBQUlFLFNBQVNDLEdBQVl2RyxXQUFXdUcsRUFBUyxPQUN0RCxDQUNBLE1BQU0sSUFBSUMsS0FDWixDQUFFLE1BQU8vRyxHQUdQLE9BRkF3RyxRQUFRQyxJQUFJekcsR0FDWkQsRUFBcUIsc0JBQ2Q4RyxRQUFRRyxPQUFPaEgsRUFDeEIsQ0FDRixDRDRCTWlILENBQVlmLEdBQ1RnQixNQUFLLElEcUZkLFdBQ0UsTUFBTUMsRUFBY2pILFNBQVNDLGNBQWMsUUFFM0NnSCxFQUFZOUcsVUFBVVEsSUFBSSwwQkFlNUIsU0FBNkJzRyxHQUNYakgsU0FBU0MsY0FBYywyQkFFL0JnRixpQkFBaUIsU0FBUyxLQUNoQ2dDLEVBQVk5RyxVQUFZLEtBRTVCLENBbkJFK0csQ0FBb0JELEVBQ3RCLENDM0ZvQkUsS0FDWEMsT0FBT3RILElBQUQsSUFDTnVILFNBQVEsS0FDUHBELEVBQWdCaUIsRUFBRUcsT0FBTzNFLGNBQWMyQyxTQUFTLElBQ2hENkIsRUFBRUcsT0FBTzNFLGNBQWMyQyxTQUFTLEdBQUd4RSxNQUFRLEdBQzNDNEYsRUFBbUNTLEVBQUVHLE9BQU0sR0FabEIsQ0FhMUIsS0FHVCxDRTNEQWlDLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWF0aGVyX2FwcC8uL3NyYy9tb2R1bGVzL3dlYXRoZXJVdGlscy5qcyIsIndlYnBhY2s6Ly93ZWF0aGVyX2FwcC8uL3NyYy9tb2R1bGVzL3VpLmpzIiwid2VicGFjazovL3dlYXRoZXJfYXBwLy4vc3JjL21vZHVsZXMvZm9ybS5qcyIsIndlYnBhY2s6Ly93ZWF0aGVyX2FwcC8uL3NyYy9tb2R1bGVzL2FwaS5qcyIsIndlYnBhY2s6Ly93ZWF0aGVyX2FwcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBnZXRGb3JtYXR0ZWRMb2NhdGlvbihsb2NhdGlvbk9iamVjdCkge1xuICByZXR1cm4gYCR7bG9jYXRpb25PYmplY3QubmFtZX0sICR7bG9jYXRpb25PYmplY3QucmVnaW9ufSAtICR7bG9jYXRpb25PYmplY3QuY291bnRyeX1gXG59XG5cbmZ1bmN0aW9uIGdldEZvcm1hdHRlZERhdGUoY3VycmVudERhdGUpIHtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGN1cnJlbnREYXRlKVxuXG4gIGNvbnN0IGRheXMgPSBbXG4gICAgXCJTdW5kYXlcIixcbiAgICBcIk1vbmRheVwiLFxuICAgIFwiVHVlc2RheVwiLFxuICAgIFwiV2VkbmVzZGF5XCIsXG4gICAgXCJUaHVyc2RheVwiLFxuICAgIFwiRnJpZGF5XCIsXG4gICAgXCJTYXR1cmRheVwiXG4gIF1cbiAgY29uc3QgbW9udGhzID0gW1xuICAgIFwiSmFudWFyeVwiLFxuICAgIFwiRmVicnVhcnlcIixcbiAgICBcIk1hcmNoXCIsXG4gICAgXCJBcHJpbFwiLFxuICAgIFwiTWF5XCIsXG4gICAgXCJKdW5lXCIsXG4gICAgXCJKdWx5XCIsXG4gICAgXCJBdWd1c3RcIixcbiAgICBcIlNlcHRlbWJlclwiLFxuICAgIFwiT2N0b2JlclwiLFxuICAgIFwiTm92ZW1iZXJcIixcbiAgICBcIkRlY2VtYmVyXCJcbiAgXVxuXG4gIHJldHVybiBgJHtkYXlzW2RhdGUuZ2V0RGF5KCldfSwgJHtcbiAgICBtb250aHNbZGF0ZS5nZXRNb250aCgpXVxuICB9ICR7ZGF0ZS5nZXREYXRlKCl9LCAke2RhdGUuZ2V0RnVsbFllYXIoKX1gXG59XG5cbmZ1bmN0aW9uIGdldEZvcm1hdHRlZFRpbWUobG9jYWx0aW1lKSB7XG4gIHJldHVybiBsb2NhbHRpbWUuc3BsaXQoXCIgXCIpWzFdXG59XG5cbmZ1bmN0aW9uIGdldEZvcm1hdHRlZEltYWdlKHdlYXRoZXIsIGZvcm1hdCwgbW9tZW50KSB7XG4gIGxldCBpbWFnZVVybFxuXG4gIGlmIChtb21lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgIGltYWdlVXJsID0gYFdlYXRoZXI9JHt3ZWF0aGVyfSwgTW9tZW50PURheS4ke2Zvcm1hdH1gXG4gIH0gZWxzZSB7XG4gICAgbW9tZW50LmlzX2RheSA/IChtb21lbnQgPSBcIkRheVwiKSA6IChtb21lbnQgPSBcIk5pZ2h0XCIpXG4gICAgaW1hZ2VVcmwgPSBgV2VhdGhlcj0ke3dlYXRoZXJ9LCBNb21lbnQ9JHttb21lbnR9LiR7Zm9ybWF0fWBcbiAgfVxuXG4gIHJldHVybiBmb3JtYXQgPT09IFwic3ZnXCJcbiAgICA/IGAuL2ltYWdlcy9pY29ucy8ke2ltYWdlVXJsfWBcbiAgICA6IGAuL2ltYWdlcy9iYWNrZ3JvdW5kcy8ke2ltYWdlVXJsfWBcbn1cblxuZnVuY3Rpb24gZ2V0TWF4VGVtcGVyYXR1cmUoZGF0YSwgaXNGb3JlY2FzdCkge1xuICByZXR1cm4gaXNGb3JlY2FzdFxuICAgID8gYCR7Z2V0Q2VpbGVkVmFsdWUoZGF0YS5kYXkubWF4dGVtcF9jKX3CsGNgXG4gICAgOiBgJHtnZXRDZWlsZWRWYWx1ZShkYXRhLnRlbXBfYyl9wrBjYFxufVxuXG5mdW5jdGlvbiBnZXRNaW5UZW1wZXJhdHVyZShmb3JlY2FzdE9iamVjdCkge1xuICByZXR1cm4gYCR7Z2V0Q2VpbGVkVmFsdWUoZm9yZWNhc3RPYmplY3QuZGF5Lm1pbnRlbXBfYyl9wrBjYFxufVxuXG5mdW5jdGlvbiBnZXRUZW1wZXJhdHVyZVJhbmdlKG1heFRlbXBlcmF0dXJlLCBmb3JlY2FzdE9iamVjdCkge1xuICByZXR1cm4gYCR7Z2V0TWluVGVtcGVyYXR1cmUoZm9yZWNhc3RPYmplY3QpfSAvICR7bWF4VGVtcGVyYXR1cmV9YFxufVxuXG5mdW5jdGlvbiBnZXRDZWlsZWRWYWx1ZSh2YWx1ZSkge1xuICByZXR1cm4gTWF0aC5jZWlsKHZhbHVlKVxufVxuXG5mdW5jdGlvbiBnZXRXZWF0aGVyQ29uZGl0aW9uVXNpbmdDb2RlKGNvZGUpIHtcbiAgY29uc3QgbmV3SWNvbnMgPSB7XG4gICAgQ2xlYXI6IFsxMDAwXSxcbiAgICBSYWluOiBbXG4gICAgICAxMDYzLCAxMDY5LCAxMTgwLCAxMTgzLCAxMTg2LCAxMTg5LCAxMTkyLCAxMTk1LCAxMTk4LCAxMjAxLCAxMjM3LCAxMjQwLFxuICAgICAgMTI0MywgMTI0NiwgMTI0OSwgMTI1MiwgMTI2MSwgMTI2NFxuICAgIF0sXG4gICAgU3Rvcm06IFsxMDg3LCAxMjczLCAxMjc2LCAxMjc5LCAxMjgyXSxcbiAgICBDbG91ZHk6IFtcbiAgICAgIDEwMDYsIDEwMDksIDEwMzAsIDEwNzIsIDExMTcsIDExMzUsIDExNDcsIDExNTAsIDExNTMsIDExNjgsIDExNzEsIDEyMDQsXG4gICAgICAxMjA3XG4gICAgXSxcbiAgICBcIkZldyBDbG91ZHNcIjogWzEwMDNdLFxuICAgIFNub3c6IFsxMDY2LCAxMTE0LCAxMjEwLCAxMjEzLCAxMjE2LCAxMjE5LCAxMjIyLCAxMjI1LCAxMjU1LCAxMjU4XVxuICB9XG4gIGNvbnN0IG1hdGNoZWRXZWF0aGVyQ29uZGl0aW9uID0gT2JqZWN0LmtleXMobmV3SWNvbnMpLmZpbmQoKGtleSkgPT5cbiAgICBuZXdJY29uc1trZXldLmluY2x1ZGVzKGNvZGUpXG4gIClcblxuICByZXR1cm4gbWF0Y2hlZFdlYXRoZXJDb25kaXRpb25cbn1cblxuZXhwb3J0IHtcbiAgZ2V0Rm9ybWF0dGVkTG9jYXRpb24sXG4gIGdldEZvcm1hdHRlZERhdGUsXG4gIGdldEZvcm1hdHRlZFRpbWUsXG4gIGdldEZvcm1hdHRlZEltYWdlLFxuICBnZXRNYXhUZW1wZXJhdHVyZSxcbiAgZ2V0TWluVGVtcGVyYXR1cmUsXG4gIGdldFRlbXBlcmF0dXJlUmFuZ2UsXG4gIGdldENlaWxlZFZhbHVlLFxuICBnZXRXZWF0aGVyQ29uZGl0aW9uVXNpbmdDb2RlXG59XG4iLCJpbXBvcnQge1xuICBnZXRGb3JtYXR0ZWRMb2NhdGlvbixcbiAgZ2V0Rm9ybWF0dGVkRGF0ZSxcbiAgZ2V0Rm9ybWF0dGVkVGltZSxcbiAgZ2V0Rm9ybWF0dGVkSW1hZ2UsXG4gIGdldE1heFRlbXBlcmF0dXJlLFxuICBnZXRNaW5UZW1wZXJhdHVyZSxcbiAgZ2V0VGVtcGVyYXR1cmVSYW5nZSxcbiAgZ2V0Q2VpbGVkVmFsdWUsXG4gIGdldFdlYXRoZXJDb25kaXRpb25Vc2luZ0NvZGVcbn0gZnJvbSBcIi4vd2VhdGhlclV0aWxzXCJcblxuZnVuY3Rpb24gdXBkYXRlU3RhdGlzdGljc0Rhc2hib2FyZCh3ZWF0aGVyRGF0YSkge1xuICBjb25zdCB1c2VyTG9jYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1ldGEtd3JhcHBlcl9fbG9jYXRpb24gcFwiKVxuICBjb25zdCBkYXRlTWV0YSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWV0YS13cmFwcGVyX19sb2NhdGlvbiB0aW1lXCIpXG4gIGNvbnN0IHRpbWVNZXRhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZXRhLXdyYXBwZXJfX3RpbWUgdGltZVwiKVxuICBjb25zdCB0ZW1wZXJhdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY3VycmVudF9fdGVtcFwiKVxuICBjb25zdCB0ZW1wZXJhdHVyZVJhbmdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yYW5nZV9fbWluLXRvLW1heFwiKVxuICBjb25zdCB3ZWF0aGVyQ29uZGl0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53ZWF0aGVyLWNvbmRpdGlvbl9fc3RyaW5nXCIpXG4gIGNvbnN0IHdlYXRoZXJJbGx1c3RyYXRpb25JbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgXCIuc3RhdC1kYXRhX19pbGx1c3RyYXRpb25cIlxuICApXG4gIGNvbnN0IHN0YXRpc3RpY3NEYXNoYm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIFwiLmhlYWRlci1jb250YWluZXJfX3N0YXRpc3RpY3NcIlxuICApXG5cbiAgdXNlckxvY2F0aW9uLnRleHRDb250ZW50ID0gZ2V0Rm9ybWF0dGVkTG9jYXRpb24od2VhdGhlckRhdGEubG9jYXRpb24pXG5cbiAgZGF0ZU1ldGEudGV4dENvbnRlbnQgPSBnZXRGb3JtYXR0ZWREYXRlKHdlYXRoZXJEYXRhLmxvY2F0aW9uLmxvY2FsdGltZSlcblxuICB0aW1lTWV0YS50ZXh0Q29udGVudCA9IGdldEZvcm1hdHRlZFRpbWUod2VhdGhlckRhdGEubG9jYXRpb24ubG9jYWx0aW1lKVxuXG4gIHRlbXBlcmF0dXJlLnRleHRDb250ZW50ID0gZ2V0TWF4VGVtcGVyYXR1cmUod2VhdGhlckRhdGEuY3VycmVudCwgZmFsc2UpXG5cbiAgdGVtcGVyYXR1cmVSYW5nZS50ZXh0Q29udGVudCA9IGdldFRlbXBlcmF0dXJlUmFuZ2UoXG4gICAgdGVtcGVyYXR1cmUudGV4dENvbnRlbnQsXG4gICAgd2VhdGhlckRhdGEuZm9yZWNhc3QuZm9yZWNhc3RkYXlbMF1cbiAgKVxuXG4gIHdlYXRoZXJDb25kaXRpb24udGV4dENvbnRlbnQgPSBnZXRXZWF0aGVyQ29uZGl0aW9uVXNpbmdDb2RlKFxuICAgIHdlYXRoZXJEYXRhLmN1cnJlbnQuY29uZGl0aW9uLmNvZGVcbiAgKVxuXG4gIHdlYXRoZXJJbGx1c3RyYXRpb25JbWFnZS5zcmMgPSBnZXRGb3JtYXR0ZWRJbWFnZShcbiAgICB3ZWF0aGVyQ29uZGl0aW9uLnRleHRDb250ZW50LFxuICAgIFwic3ZnXCIsXG4gICAgd2VhdGhlckRhdGEuY3VycmVudFxuICApXG5cbiAgc3RhdGlzdGljc0Rhc2hib2FyZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKFwiJHtnZXRGb3JtYXR0ZWRJbWFnZShcbiAgICB3ZWF0aGVyQ29uZGl0aW9uLnRleHRDb250ZW50LFxuICAgIFwicG5nXCIsXG4gICAgd2VhdGhlckRhdGEuY3VycmVudFxuICApfVwiKWBcbn1cblxuZnVuY3Rpb24gdXBkYXRlR2VuZXJhbFN0YXRpc3RpY3Mod2VhdGhlckRhdGEpIHtcbiAgY29uc3Qgc3RhdFZhbHVlcyA9IHtcbiAgICB0aGVybWFsU2Vuc2F0aW9uOiBgJHtnZXRDZWlsZWRWYWx1ZSh3ZWF0aGVyRGF0YS5jdXJyZW50LmZlZWxzbGlrZV9jKX3CsGNgLFxuICAgIHJhaW5Qcm9iYWJpbGl0eTogYCR7d2VhdGhlckRhdGEuZm9yZWNhc3QuZm9yZWNhc3RkYXlbMF0uZGF5LmRhaWx5X2NoYW5jZV9vZl9yYWlufSVgLFxuICAgIHdpbmRTcGVlZDogYCR7Z2V0Q2VpbGVkVmFsdWUod2VhdGhlckRhdGEuY3VycmVudC53aW5kX2twaCl9IEttL2hgLFxuICAgIGh1bWlkaXR5OiBgJHt3ZWF0aGVyRGF0YS5jdXJyZW50Lmh1bWlkaXR5fSVgLFxuICAgIHV2SW5kZXg6IHdlYXRoZXJEYXRhLmN1cnJlbnQudXZcbiAgfVxuXG4gIGNvbnN0IGtleXNGb3JTdGF0VmFsdWVzID0gT2JqZWN0LmtleXMoc3RhdFZhbHVlcylcblxuICBjb25zdCBnZW5lcmFsU3RhdGlzdGljc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIFwiLm92ZXJ2aWV3LXNlY3Rpb25fX2xpc3RcIlxuICApXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBnZW5lcmFsU3RhdGlzdGljc0xpc3QuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICBnZW5lcmFsU3RhdGlzdGljc0xpc3QuY2hpbGRyZW5baV0uY2hpbGRyZW5bMV0udGV4dENvbnRlbnQgPVxuICAgICAgc3RhdFZhbHVlc1trZXlzRm9yU3RhdFZhbHVlc1tpXV1cbiAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVQcmVkaWN0aW9ucyh3ZWF0aGVyRGF0YSkge1xuICBjb25zdCBmdXR1cmVQcmVkaWN0aW9ucyA9IHdlYXRoZXJEYXRhLmZvcmVjYXN0LmZvcmVjYXN0ZGF5XG4gIGNvbnN0IGxpc3RXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcmVkaWN0aW9uc19fbGlzdFwiKVxuXG4gIGxpc3RXcmFwcGVyLmlubmVySFRNTCA9IFwiXCJcblxuICBmb3IgKGxldCBpID0gMTsgaSA8IGZ1dHVyZVByZWRpY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgbGlzdEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIilcbiAgICBjb25zdCBjdXJyZW50V2VhdGhlciA9IGZ1dHVyZVByZWRpY3Rpb25zW2ldXG5cbiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IGN1cnJlbnRXZWF0aGVyLmRhdGVcbiAgICBjb25zdCBmb3JtYXR0ZWREYXkgPSBnZXRGb3JtYXR0ZWREYXRlKGN1cnJlbnREYXRlKS5zcGxpdChcIixcIilbMF1cbiAgICBjb25zdCB3ZWF0aGVyQ29kZSA9IGN1cnJlbnRXZWF0aGVyLmRheS5jb25kaXRpb24uY29kZVxuICAgIGNvbnN0IHdlYXRoZXJDb25kaXRpb24gPSBnZXRXZWF0aGVyQ29uZGl0aW9uVXNpbmdDb2RlKHdlYXRoZXJDb2RlKVxuXG4gICAgbGlzdEl0ZW0uaW5uZXJIVE1MID0gYDxzcGFuIGNsYXNzPVwibGlzdF9fZGF5XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtmb3JtYXR0ZWREYXkuc3Vic3RyaW5nKDAsIDMpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJkYXlfX3RyaW1tZWQtcGFydFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1hdHRlZERheS5zdWJzdHJpbmcoMyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHtnZXRGb3JtYXR0ZWRJbWFnZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlYXRoZXJDb25kaXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN2Z1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cIiBhbHQ9XCJcIj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwibGlzdF9fc3RhdHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJzdGF0c19fd2VhdGhlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJ3ZWF0aGVyX19zci1vbmx5XCI+V2VhdGhlciBDb25kaXRpb248L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke3dlYXRoZXJDb25kaXRpb259XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpc3RfX3RlbXAtcmFuZ2VcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJ0ZW1wLXJhbmdlX19zci1vbmx5XCI+VGVtcGVyYXR1cmUgUmFuZ2U8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2dldE1heFRlbXBlcmF0dXJlKGN1cnJlbnRXZWF0aGVyLCB0cnVlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGFiYnIgdGl0bGU9XCJ0b1wiIGNsYXNzPVwic3Itb25seVwiPi08L2FiYnI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwidGVtcC1yYW5nZV9fdG9cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7Z2V0TWluVGVtcGVyYXR1cmUoY3VycmVudFdlYXRoZXIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+YFxuXG4gICAgbGlzdFdyYXBwZXIuYXBwZW5kQ2hpbGQobGlzdEl0ZW0pXG4gIH1cbn1cblxuZnVuY3Rpb24gaW5zdGFudGlhdGU0MDRQcm9tcHQoZXJyb3IpIHtcbiAgY29uc3QgZXJyb3JQcm9tcHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW5fX2Vycm9yLXByb21wdGVyXCIpXG4gIGNvbnN0IGVycm9yQ29udmV5aW5nVGV4dCA9IGVycm9yUHJvbXB0LnF1ZXJ5U2VsZWN0b3IoXG4gICAgXCIuZXJyb3ItcHJvbXB0ZXJfX2hlYWRpbmdcIlxuICApXG5cbiAgZXJyb3JDb252ZXlpbmdUZXh0LnRleHRDb250ZW50ID0gZXJyb3JcbiAgZXJyb3JQcm9tcHQuY2xhc3NMaXN0LnRvZ2dsZShcIm1haW5fX2Vycm9yLXByb21wdGVyLS1hY3RpdmVcIilcblxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBlcnJvclByb21wdC5jbGFzc0xpc3QudG9nZ2xlKFwibWFpbl9fZXJyb3ItcHJvbXB0ZXItLWFjdGl2ZVwiKVxuICB9LCA0MDAwKVxufVxuXG5mdW5jdGlvbiBhY3RpdmF0ZURhc2hib2FyZCgpIHtcbiAgY29uc3QgbWFpbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKVxuXG4gIG1haW5FbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtYWluLS1kYXNoYm9hcmQtYWN0aXZlXCIpXG5cbiAgZGVhY3RpdmF0ZURhc2hib2FyZChtYWluRWxlbWVudClcbn1cblxuZnVuY3Rpb24gYWN0aXZhdGVJbnRyb0Zvcm0obGlzdFdyYXBwZXIsIHN0YXRlKSB7XG4gIGNvbnN0IGludHJvRm9ybVNlY3Rpb24gPSBsaXN0V3JhcHBlci5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnRcblxuICBpZiAoaW50cm9Gb3JtU2VjdGlvbi5jbGFzc0xpc3RbMF0gIT09IFwibWFpbl9faW50cm9cIikgcmV0dXJuXG5cbiAgc3RhdGUgPT09IFwib25cIlxuICAgID8gaW50cm9Gb3JtU2VjdGlvbi5jbGFzc0xpc3QuYWRkKFwibWFpbl9faW50cm8tLWZvcm0tYWN0aXZhdGVkXCIpXG4gICAgOiAoaW50cm9Gb3JtU2VjdGlvbi5jbGFzc05hbWUgPSBcIm1haW5fX2ludHJvXCIpXG59XG5cbmZ1bmN0aW9uIGRlYWN0aXZhdGVEYXNoYm9hcmQobWFpbkVsZW1lbnQpIHtcbiAgY29uc3QgaG9tZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyLXdyYXBwZXJfX2hlYWRlclwiKVxuXG4gIGhvbWVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBtYWluRWxlbWVudC5jbGFzc0xpc3QgPSBcIlwiXG4gIH0pXG59XG5cbmZ1bmN0aW9uIGluc3RhbnRpYXRlVUlDaGFuZ2VzKGpzb25SZXNwb25zZSkge1xuICB1cGRhdGVTdGF0aXN0aWNzRGFzaGJvYXJkKGpzb25SZXNwb25zZSlcbiAgdXBkYXRlR2VuZXJhbFN0YXRpc3RpY3MoanNvblJlc3BvbnNlKVxuICB1cGRhdGVQcmVkaWN0aW9ucyhqc29uUmVzcG9uc2UpXG59XG5cbmV4cG9ydCB7XG4gIGluc3RhbnRpYXRlVUlDaGFuZ2VzLFxuICBpbnN0YW50aWF0ZTQwNFByb21wdCxcbiAgYWN0aXZhdGVEYXNoYm9hcmQsXG4gIGFjdGl2YXRlSW50cm9Gb3JtXG59XG4iLCJpbXBvcnQgeyBtYWtlQXBpQ2FsbCB9IGZyb20gXCIuL2FwaVwiXG5pbXBvcnQge1xuICBhY3RpdmF0ZURhc2hib2FyZCxcbiAgYWN0aXZhdGVJbnRyb0Zvcm0sXG4gIGluc3RhbnRpYXRlNDA0UHJvbXB0XG59IGZyb20gXCIuL3VpXCJcblxuZnVuY3Rpb24gaW5zdGFudGlhdGVGb3JtKCkge1xuICBjb25zdCBpbnB1dEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImlucHV0XCIpXG4gIGNvbnN0IGZvcm1FbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJmb3JtXCIpXG4gIGNvbnN0IGxpc3RXcmFwcGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9fc3VnZ2VzdGlvbnMtbGlzdFwiKVxuICBjb25zdCBzdWJtaXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19zdWJtaXQtYnRuXCIpXG5cbiAgZm9ybUVsZW1lbnRzLmZvckVhY2goKGVsKSA9PlxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IGUucHJldmVudERlZmF1bHQoKSlcbiAgKVxuXG4gIGlucHV0RWxlbWVudHMuZm9yRWFjaCgoZWwpID0+XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICBjb25zdCBxdWVyeSA9IGUudGFyZ2V0LnZhbHVlLnRvTG93ZXJDYXNlKClcblxuICAgICAgcXVlcnkgIT09IFwiXCJcbiAgICAgICAgPyBkaXNwbGF5U3VnZ2VzdGlvbnMoY3VzdG9tRmlsdGVyKHF1ZXJ5KSwgZS50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nKVxuICAgICAgICA6IGhpZGVTdWdnZXN0aW9ucyhlLnRhcmdldC5uZXh0RWxlbWVudFNpYmxpbmcpXG4gICAgfSlcbiAgKVxuXG4gIGxpc3RXcmFwcGVycy5mb3JFYWNoKChlbCkgPT5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIilcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnByZXZpb3VzRWxlbWVudFNpYmxpbmcudmFsdWUgPVxuICAgICAgICAgICAgZS50YXJnZXQudGV4dENvbnRlbnRcbiAgICAgICAgICBoaWRlU3VnZ2VzdGlvbnMoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LCBcImRvbnRIaWRlQnRuXCIpXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7fVxuICAgICAgfSwgNTAwKVxuICAgIH0pXG4gIClcblxuICBzdWJtaXRCdG5zLmZvckVhY2goKGJ0bikgPT5cbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBjb25zdCBsb2NhdGlvblRvU2VhcmNoID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5jaGlsZHJlblsxXS52YWx1ZVxuXG4gICAgICBpZiAobG9jYXRpb25Ub1NlYXJjaCA9PT0gXCJcIikgcmV0dXJuXG4gICAgICBpZiAoIW5hdmlnYXRvci5vbkxpbmUpXG4gICAgICAgIHJldHVybiBpbnN0YW50aWF0ZTQwNFByb21wdChcIk9vcHMhIFlvdSdyZSBjdXJyZW50bHkgb2ZmbGluZVwiKVxuXG4gICAgICB0b2dnbGVMb2FkaW5nQW5pbWF0aW9uRm9yU3VibWl0QnRuKGUudGFyZ2V0KVxuXG4gICAgICBtYWtlQXBpQ2FsbChsb2NhdGlvblRvU2VhcmNoKVxuICAgICAgICAudGhlbigoKSA9PiBhY3RpdmF0ZURhc2hib2FyZCgpKVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7fSlcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgIGhpZGVTdWdnZXN0aW9ucyhlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNoaWxkcmVuWzJdKVxuICAgICAgICAgIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuY2hpbGRyZW5bMV0udmFsdWUgPSBcIlwiXG4gICAgICAgICAgdG9nZ2xlTG9hZGluZ0FuaW1hdGlvbkZvclN1Ym1pdEJ0bihlLnRhcmdldClcbiAgICAgICAgfSlcbiAgICB9KVxuICApXG59XG5cbmZ1bmN0aW9uIGhpZGVTdWdnZXN0aW9ucyhsaXN0V3JhcHBlckVsLCBjYW5IaWRlU3VibWl0QnRuKSB7XG4gIGxpc3RXcmFwcGVyRWwuc3R5bGUub3BhY2l0eSA9IDBcbiAgYWN0aXZhdGVJbnRyb0Zvcm0obGlzdFdyYXBwZXJFbCwgXCJvZmZcIilcbiAgY2FuSGlkZVN1Ym1pdEJ0biA9PT0gdW5kZWZpbmVkXG4gICAgPyBzdWJtaXRCdG5TdGF0ZU1vZGlmaWVyKGxpc3RXcmFwcGVyRWwubmV4dEVsZW1lbnRTaWJsaW5nLCBcImRpc2FibGVkXCIpXG4gICAgOiBudWxsXG5cbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgbGlzdFdyYXBwZXJFbC5pbm5lckhUTUwgPSBcIlwiXG4gIH0sIDYwMClcbn1cblxuZnVuY3Rpb24gZGlzcGxheVN1Z2dlc3Rpb25zKHN1Z2dlc3Rpb25zTGlzdCwgbGlzdFdyYXBwZXJFbCkge1xuICBsaXN0V3JhcHBlckVsLmlubmVySFRNTCA9IFwiXCJcblxuICBzdWdnZXN0aW9uc0xpc3QuZm9yRWFjaCgoc3VnZ2VzdGlvbikgPT4ge1xuICAgIGNvbnN0IGxpc3RJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpXG5cbiAgICBsaXN0SXRlbS5pbm5lckhUTUwgPSBgPGJ1dHRvbj4ke3N1Z2dlc3Rpb259PC9idXR0b24+YFxuICAgIGxpc3RXcmFwcGVyRWwuYXBwZW5kQ2hpbGQobGlzdEl0ZW0pXG4gIH0pXG5cbiAgYWN0aXZhdGVJbnRyb0Zvcm0obGlzdFdyYXBwZXJFbCwgXCJvblwiKVxuXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGxpc3RXcmFwcGVyRWwuc3R5bGUub3BhY2l0eSA9IDFcbiAgICBzdWJtaXRCdG5TdGF0ZU1vZGlmaWVyKGxpc3RXcmFwcGVyRWwubmV4dEVsZW1lbnRTaWJsaW5nLCBcImFjdGl2ZVwiKVxuICB9LCAxMDApXG59XG5cbmZ1bmN0aW9uIGN1c3RvbUZpbHRlcihxdWVyeSkge1xuICBjb25zdCBtYXRjaGVzID0gW11cblxuICBmb3IgKGNvbnN0IGl0ZW0gb2YgZGF0YSkge1xuICAgIGlmIChpdGVtLnN1YnN0cigwLCBxdWVyeS5sZW5ndGgpLnRvTG93ZXJDYXNlKCkgPT0gcXVlcnkpIHtcbiAgICAgIG1hdGNoZXMucHVzaChpdGVtKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBtYXRjaGVzXG59XG5cbmZ1bmN0aW9uIHN1Ym1pdEJ0blN0YXRlTW9kaWZpZXIoc3VibWl0QnRuLCBzdGF0ZSkge1xuICBzdGF0ZSA9PT0gXCJhY3RpdmVcIlxuICAgID8gc3VibWl0QnRuLmNsYXNzTGlzdC5hZGQoXCJmb3JtX19zdWJtaXQtYnRuLS1hY3RpdmVcIilcbiAgICA6IHN1Ym1pdEJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiZm9ybV9fc3VibWl0LWJ0bi0tYWN0aXZlXCIpXG59XG5cbmZ1bmN0aW9uIHRvZ2dsZUxvYWRpbmdBbmltYXRpb25Gb3JTdWJtaXRCdG4oc3VibWl0QnRuKSB7XG4gIHN1Ym1pdEJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiZm9ybV9fc3VibWl0LWJ0bi0tbG9hZGluZ1wiKVxufVxuXG5leHBvcnQgeyBpbnN0YW50aWF0ZUZvcm0gfVxuIiwiaW1wb3J0IHsgaW5zdGFudGlhdGVVSUNoYW5nZXMsIGluc3RhbnRpYXRlNDA0UHJvbXB0IH0gZnJvbSBcIi4vdWlcIlxuXG5hc3luYyBmdW5jdGlvbiBtYWtlQXBpQ2FsbChsb2NhdGlvbikge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICBgaHR0cDovL2xvY2FsaG9zdDozMDAwL3dlYXRoZXI/bG9jYXRpb249JHtsb2NhdGlvbn1gXG4gICAgKVxuICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKVxuICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QganNvbkRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcblxuICAgICAgY29uc29sZS5sb2coanNvbkRhdGEpXG5cbiAgICAgIGluc3RhbnRpYXRlVUlDaGFuZ2VzKGpzb25EYXRhKVxuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTUwMCkpXG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcigpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgaW5zdGFudGlhdGU0MDRQcm9tcHQoXCJMb2NhdGlvbiBub3QgZm91bmRcIilcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpXG4gIH1cbn1cblxuZXhwb3J0IHsgbWFrZUFwaUNhbGwgfVxuIiwiaW1wb3J0IHsgaW5zdGFudGlhdGVGb3JtIH0gZnJvbSBcIi4vbW9kdWxlcy9mb3JtXCJcblxuaW5zdGFudGlhdGVGb3JtKClcbiJdLCJuYW1lcyI6WyJnZXRGb3JtYXR0ZWREYXRlIiwiY3VycmVudERhdGUiLCJkYXRlIiwiRGF0ZSIsImdldERheSIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldEZ1bGxZZWFyIiwiZ2V0Rm9ybWF0dGVkSW1hZ2UiLCJ3ZWF0aGVyIiwiZm9ybWF0IiwibW9tZW50IiwiaW1hZ2VVcmwiLCJ1bmRlZmluZWQiLCJpc19kYXkiLCJnZXRNYXhUZW1wZXJhdHVyZSIsImRhdGEiLCJpc0ZvcmVjYXN0IiwiZ2V0Q2VpbGVkVmFsdWUiLCJkYXkiLCJtYXh0ZW1wX2MiLCJ0ZW1wX2MiLCJnZXRNaW5UZW1wZXJhdHVyZSIsImZvcmVjYXN0T2JqZWN0IiwibWludGVtcF9jIiwidmFsdWUiLCJNYXRoIiwiY2VpbCIsImdldFdlYXRoZXJDb25kaXRpb25Vc2luZ0NvZGUiLCJjb2RlIiwibmV3SWNvbnMiLCJDbGVhciIsIlJhaW4iLCJTdG9ybSIsIkNsb3VkeSIsIlNub3ciLCJPYmplY3QiLCJrZXlzIiwiZmluZCIsImtleSIsImluY2x1ZGVzIiwiaW5zdGFudGlhdGU0MDRQcm9tcHQiLCJlcnJvciIsImVycm9yUHJvbXB0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJzZXRUaW1lb3V0IiwiYWN0aXZhdGVJbnRyb0Zvcm0iLCJsaXN0V3JhcHBlciIsInN0YXRlIiwiaW50cm9Gb3JtU2VjdGlvbiIsInBhcmVudEVsZW1lbnQiLCJhZGQiLCJjbGFzc05hbWUiLCJpbnN0YW50aWF0ZVVJQ2hhbmdlcyIsImpzb25SZXNwb25zZSIsIndlYXRoZXJEYXRhIiwidXNlckxvY2F0aW9uIiwiZGF0ZU1ldGEiLCJ0aW1lTWV0YSIsInRlbXBlcmF0dXJlIiwidGVtcGVyYXR1cmVSYW5nZSIsIndlYXRoZXJDb25kaXRpb24iLCJ3ZWF0aGVySWxsdXN0cmF0aW9uSW1hZ2UiLCJzdGF0aXN0aWNzRGFzaGJvYXJkIiwibG9jYXRpb25PYmplY3QiLCJtYXhUZW1wZXJhdHVyZSIsImxvY2F0aW9uIiwibmFtZSIsInJlZ2lvbiIsImNvdW50cnkiLCJsb2NhbHRpbWUiLCJzcGxpdCIsImN1cnJlbnQiLCJmb3JlY2FzdCIsImZvcmVjYXN0ZGF5IiwiY29uZGl0aW9uIiwic3JjIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJ1cGRhdGVTdGF0aXN0aWNzRGFzaGJvYXJkIiwic3RhdFZhbHVlcyIsInRoZXJtYWxTZW5zYXRpb24iLCJmZWVsc2xpa2VfYyIsInJhaW5Qcm9iYWJpbGl0eSIsImRhaWx5X2NoYW5jZV9vZl9yYWluIiwid2luZFNwZWVkIiwid2luZF9rcGgiLCJodW1pZGl0eSIsInV2SW5kZXgiLCJ1diIsImtleXNGb3JTdGF0VmFsdWVzIiwiZ2VuZXJhbFN0YXRpc3RpY3NMaXN0IiwiaSIsImNoaWxkcmVuIiwibGVuZ3RoIiwidXBkYXRlR2VuZXJhbFN0YXRpc3RpY3MiLCJmdXR1cmVQcmVkaWN0aW9ucyIsImlubmVySFRNTCIsImxpc3RJdGVtIiwiY3JlYXRlRWxlbWVudCIsImN1cnJlbnRXZWF0aGVyIiwiZm9ybWF0dGVkRGF5Iiwic3Vic3RyaW5nIiwiYXBwZW5kQ2hpbGQiLCJ1cGRhdGVQcmVkaWN0aW9ucyIsImhpZGVTdWdnZXN0aW9ucyIsImxpc3RXcmFwcGVyRWwiLCJjYW5IaWRlU3VibWl0QnRuIiwib3BhY2l0eSIsInN1Ym1pdEJ0blN0YXRlTW9kaWZpZXIiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJzdWJtaXRCdG4iLCJyZW1vdmUiLCJ0b2dnbGVMb2FkaW5nQW5pbWF0aW9uRm9yU3VibWl0QnRuIiwiaW5wdXRFbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JtRWxlbWVudHMiLCJsaXN0V3JhcHBlcnMiLCJzdWJtaXRCdG5zIiwiZm9yRWFjaCIsImVsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInF1ZXJ5IiwidGFyZ2V0IiwidG9Mb3dlckNhc2UiLCJzdWdnZXN0aW9uc0xpc3QiLCJtYXRjaGVzIiwiaXRlbSIsInN1YnN0ciIsInB1c2giLCJjdXN0b21GaWx0ZXIiLCJzdWdnZXN0aW9uIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImJ0biIsImxvY2F0aW9uVG9TZWFyY2giLCJuYXZpZ2F0b3IiLCJvbkxpbmUiLCJhc3luYyIsInJlc3BvbnNlIiwiZmV0Y2giLCJjb25zb2xlIiwibG9nIiwib2siLCJqc29uRGF0YSIsImpzb24iLCJQcm9taXNlIiwicmVzb2x2ZSIsIkVycm9yIiwicmVqZWN0IiwibWFrZUFwaUNhbGwiLCJ0aGVuIiwibWFpbkVsZW1lbnQiLCJkZWFjdGl2YXRlRGFzaGJvYXJkIiwiYWN0aXZhdGVEYXNoYm9hcmQiLCJjYXRjaCIsImZpbmFsbHkiLCJpbnN0YW50aWF0ZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9